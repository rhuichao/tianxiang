<h3>员工考勤列表</h3>

<%= form_tag("/attendances/search") %>
	<div class="field">
		<%= label_tag("year", "选择年份") %>
		<%= text_field_tag 'year', @year %>
		<%= submit_tag "查询" %>
	</div>
<% $end %>
<table class="table table-striped">
  <tr>
    <th>工号</th>
    <th>姓名</th>

		<% (1..@months.size).each do |month| %>
		<th>
			<% if @year.nil? or @year.empty? or @attendances.size == 0 %>
				<%= month %>月
			<% else %>
				<a href='/attendances/<%= @year %>/<%= month %>/edit'><%= month %>月</a>
			<% end %>
		</th>
		<% end %>

  </tr>
	<% if !@year.nil? and !@year.empty? %>
	<% @employees.each do |employee| %>
  <tr>
    <td><%= employee.id_card %></td>
    <td><%= employee.name %></td>
		<% (1..@months.size).each do |month| %>
			<% work_time = @employee_attendance[employee.id][month-1] %>
			<% if work_time == @work_days[month]%>
				<td class="full_work_time"><%= @employee_attendance[employee.id][month-1] %>(满)</td>
			<% else %>
				<td><%= @employee_attendance[employee.id][month-1] %></td>
			<% end %>
		<% end %>
  </tr>
	<% end %>
	<% end %>
</table>
 
<br />
 
<%= link_to '新建员工考勤', new_attendance_path %>